<html>
<head>

<!-- jquery plugins -->
<script src="js/jquery-1.10.2.js"></script>
<script src="js/jquery.easing.1.3.js"></script>
<script src="js/jquery.ui.effect.js"></script>
<script src="js/jquery.ui.effect-slide.js"></script>
<script src="js/jquery.ui.core.js"></script>
<script src="js/jquery.ui.widget.js"></script>
<script src="js/jquery.ui.mouse.js"></script>
<script src="js/jquery.ui.draggable.js"></script>
<script src="js/jquery.ui.droppable.js"></script>
<script src="js/jquery.ui.effect-drop.js"></script>
<script src="js/jquery.ui.resizable.js"></script>

<!-- CSS -->

<link rel="stylesheet" type="text/css" href="Mini-Weebly.css">

<!-- Favicon Image -->
<link rel="shortcut icon" href="Images/favicon.ico" type="image/x-icon">

<!-- Font -->
<style>
		@font-face {
			font-family: 'ProximaNova';
			src: url('Assets/Font/ProximaNova-Reg.otf') format('truetype');
		}
		
		@font-face {
			font-family: 'ProximaNova';
			font-weight: bold;
			src: url('Assets/Font/ProximaNova-Sbold.otf') format('truetype');
		}
</style>







<script type="text/javascript">

$( document ).ready(function()
	{
	var upload_button = document.getElementById("upload_button");
	var preview = document.getElementById('preview');
	});
	
//var uploadedFiles = [];
var uploadedCount  = 0;

//SHOW IMAGE AND IAMGE DETAILS
function handleFiles(files) { 
	var already_chosen = 0;
	 
    for (var i = 0; i < files.length; i++) {  
        var file = files[i]; 
		
		if (!file.type.match("image/*")) {
			alert("INCORRECT FILE TYPE!");
			}
		else
			{
			/*
			var copy = 0;
			for (var j = 0; j < uploadedCount; j++)
				{
				if (file.name == uploadedFiles[j].name)
					{
					alert("FILE ALREADY CHOSEN!");
					++already_chosen;
					copy = 1;
					}
				}
			*/
			//if (copy == 0)
				//{
				create_art(file, i - already_chosen);
				//uploadedFiles[uploadedCount] = file;
				uploadedCount++;
				//}
			}
	}
}

function create_art(file, i)
			{		
				var container = document.createElement("div");
				container.className = "container";
				container.style.display = "none";
				preview.appendChild(container);
				
				var flipping = document.createElement("div");
				flipping.className = "flipping_div";
				container.appendChild(flipping);
				
				var overflow = document.createElement("div");
				overflow.classList.add("overflow_image");
				flipping.appendChild(overflow);
				
				var img = document.createElement("img");  
				img.classList.add("image");			
				img.file = file;  
				overflow.appendChild(img);
				
				var back_info = document.createElement('div');
				back_info.classList.add("info");			
				flipping.appendChild(back_info);
				
				var flip = document.createElement("div");
				flip.classList.add("flip");
				container.appendChild(flip);
				
				var remove = document.createElement("div");
				remove.classList.add("remove");
				container.appendChild(remove);
				
				var reader = new FileReader();  
				reader.onload = (function(aImg) {
					return function(e) { 
						$(aImg).load(function() {	
							ratio = aImg.height / aImg.width;
						
							if (ratio < 1)
								{
								aImg.style.height = "180px";
								aImg.style.width = "auto";								
								aImg.style.left = (-180/ratio + 180)/2 + "px";
								}
							else
								{
								aImg.style.width = "180px";
								aImg.style.height = "auto";
								aImg.style.top = (-180*ratio + 180)/2 + "px";
								}
						}).attr("src", e.target.result);
					};
				})(img);
				reader.readAsDataURL(file);
											
				if (uploadedCount % 2 ==1)
					{
					$(upload_button).animate({ left:'-200', top:'200px' }, 2000, function(){
						$(container).fadeIn(1000);
						container.style.display = "block";
						upload_button.style.left = "0px";
						upload_button.style.top = "0px";
						});				
					}
				else	
					{
					$(upload_button).animate({ left:'200' }, 2000, function(){
						$(container).fadeIn(1000);
						container.style.display = "block";
						upload_button.style.left= "0px";
						});
					}
					
				$( container ).hover(
					function() {
						$(flip).fadeIn();
						$(remove).fadeIn();
					}, function() {
						$(flip).stop(true, false).fadeOut();
						$(remove).stop(true, false).fadeOut();
				});
				
				$(flip).click(function(){
					if ( $( flipping ).hasClass( "flipped" ) )
						{
						$( flipping ).removeClass( "flipped" );
						}
					else
						{
						$( ".flipping_div" ).removeClass( "flipped" );
						$(flipping).addClass("flipped");	
						}
				});
				
				$(remove).click(function(){
					var artworks = preview.childNodes;
					var move = 0;
					
					$(container).children().fadeOut("1000"); 
					
					setTimeout(function()
						{
						for(i=0; i<artworks.length; i++)
							{
   							if (container == artworks[i])
								{
								move = i;
								}
							}
							
						for(j=move+1; j<artworks.length; j++)
							{
   							if (j%2 == 1)
								$(artworks[j]).animate({ left:'-200' }, 2000).css({"z-index": '1'});
							else
								$(artworks[j]).animate({ left:'200', top:'-200' }, 2000).css({"z-index": '2'});
							}
						
						if (artworks.length%2 == 1)
							$(upload_button).animate({ left:'-200' }, 2000).css({"z-index": '1'});
						else
							$(upload_button).animate({ left:'200', top:'-200' }, 2000).css({"z-index": '2'});
						
							
						setTimeout(function()
							{
							$(container).remove();
							$(".container").animate({ left:'0', top:'0' }, 0).css({"z-index": '1'});
							--uploadedCount;
							}, 2000);
						}, 1000);
				});
			}  

</script>

<style>

.container
	{
	display:block;
	float:left;
	position:relative;
	width:200px;
	height:200px;
	padding:0px;
	
	-webkit-perspective: 500px;
    	-moz-perspective: 500px;
    		-o-perspective: 500px;
    			perspective: 500px;	
	}

.flipping_div
	{
	width:100%;
	height:100%;
	
	-webkit-transition: -webkit-transform 1s;
    	-moz-transition: -moz-transform 1s;
     		-o-transition: -o-transform 1s;
      			transition: transform 1s;
      -webkit-transform-style: preserve-3d;
         -moz-transform-style: preserve-3d;
           -o-transform-style: preserve-3d;
              transform-style: preserve-3d;	
	}

.overflow_image
	{
	z-index:1;
	display:block;
    width: 180px;
    height: 180px;
    box-shadow: 5px 5px 5px #888888;
	margin-left:10px;
	margin-top:10px;
	position:absolute;
	overflow:hidden;
	}

.overflow_image:active
	{
	box-shadow: 0px 0px 0px #888888;
	margin-left:13px;
	margin-top:13px;
	}

.image
	{
	display:block;
	position:absolute;
	z-index:1;
	}	

.info
	{
	z-index:2;
	opacity: 0.9;
	background-color:#d3d3d3;
	display:block;
    width: 180px;
    height: 180px;
    box-shadow: 5px 5px 5px #888888;
	margin-left:10px;
	margin-top:10px;
	overflow:hidden;
	position: absolute;

	-webkit-transform: rotateY( 180deg );
         -moz-transform: rotateY( 180deg );
           -o-transform: rotateY( 180deg );
              transform: rotateY( 180deg );
	
	-webkit-backface-visibility: hidden;
    	-moz-backface-visibility: hidden;
           -o-backface-visibility: hidden;
              backface-visibility: hidden; 
	}
	
.flip
	{
	background-color:green;
	border-radius:50%;
	height:20px;
	width:20px;
	top:0px;
	right:30px;
	position:absolute;
	display:none;
	}

.remove
	{
	background-color:red;
	border-radius:50%;
	height:20px;
	width:20px;
	top:0px;
	right:0px;
	position:absolute;
	display:none;
	}

.flipped 
	{
      -webkit-transform: rotateY( 180deg );
         -moz-transform: rotateY( 180deg );
           -o-transform: rotateY( 180deg );
              transform: rotateY( 180deg );
	}
	
.button 
	{
	display:block;
    width: 180px;
    height: 180px;
    box-shadow: 5px 5px 5px #888888;
	margin-left:auto;
	margin-right:auto;
	position:relative;
	background-color:#CCC;
	margin-top:10px;
	}

.button:hover
	{
	background-color:#9F3;	
	}

.upload
	{
    width: 180px;
    height: 180px;
	position:absolute;
	top: 0;
	left: 0;
	margin: 0;
	padding: 0;
	cursor: pointer;
	opacity: 0;
	filter: alpha(opacity=0);
	}
	
</style>













<script type="text/javascript">
// Global Variables
var pagecount = 0;	
var currentBUTTON = 0;
var currentPAGE;

// create "HOME" page and elements on page load
$( document ).ready(function()
{
newBOX("load");
setTimeout(function() { 
	dropFunction(currentPAGE, 'NavElement');
	dropFunction(currentPAGE, 'ImageElement');
	dropFunction(currentPAGE, 'TitleElement');
	dropFunction(currentPAGE, 'TextElement');
}, 300);
});

// Function that is called when a new page is created
// Time specifies if the function is performed on page load or by the user
function newBOX(time) 
{
	++pagecount;
// Javascript for buttons in template header
	var outside = document.createElement('div');
	outside.className="ButtonOutside";
	document.getElementById('Wcontainer').appendChild(outside);
		
	var inside = document.createElement('div');
	outside.appendChild(inside);
	if (pagecount==1)
		inside.className="Current ButtonInside";
	else
		inside.className="Other ButtonInside";
	
	var pageNAME = document.createElement('input')	
	pageNAME.className="textBOXbutton";
	$(pageNAME).attr('maxlength', '20');  
	var pageTitle;
	if (time == "load")
		{
		pageTitle = "HOME"
		pageNAME.value = "HOME";
		}
	else
		{
		pageTitle = document.getElementById('pageTEXT').value; 	
		if(pageTitle != "")
			pageNAME.value = pageTitle; 
		else
		pageNAME.value = "UNTITLED";
		}
	document.getElementById('pageTEXT').value = "";
	inside.appendChild(pageNAME);
	pageNAME.disabled = true;
	
//Javascript for new droppable page area 

/*
	var page = document.createElement('div');
	page.className="droppable";
	$( page ).droppable({ 
		accept: ".draggable", 
		drop: function(){dropFunction(this, "none")}
	});
	
	if (time == "load")
		currentPAGE = page;
	
	document.getElementById('droppableParent').appendChild(page);
	if (pagecount==1){
		$(page).fadeIn( "fast");
		currentPAGE = page;
	}
*/

// Javascript for delete icon
	var deleteICON = document.createElement('img');
	deleteICON.className="deleteICON";
	$(deleteICON).attr("src","Images/Delete-Icon.png");
	inside.appendChild(deleteICON);
	$(deleteICON).hover(
 		function() {
			$(deleteICON).attr("src","Images/Delete-Icon Hover.png");
            $(inside).stop(true, true).addClass('red', 500);
  		}, function() {
        	$(deleteICON).attr("src","Images/Delete-Icon.png");
            $(inside).stop(true, true).removeClass('red', 500);

        }
    );
	deleteICON.onclick = function() {removeBOX(outside, inside/*, page*/);}

// Javascript for edit icon
	var editICON = document.createElement('img');
	editICON.className="editICON";
	$(editICON).attr("src","Images/Edit-Icon.png");
	inside.appendChild(editICON);
	$(editICON).hover(
 		function() {
			$(editICON).attr("src","Images/Edit-Icon Hover.png");
  		}, function() {
        	 $(editICON).attr("src","Images/Edit-Icon.png");
	});
	editICON.onclick = function() {
		pageNAME.disabled = false;
		pageNAME.focus();
		pageNAME.onblur=function(){
			pageNAME.disabled = true;
			};
        $(pageNAME).keypress(function( event ) {
                                if ( event.which == 13 )
                                    pageNAME.blur();
        })
    }

// javascript for new page button animation    
 	if (time == "load")
		{
		$(outside).show();
		$(inside).show();		
		}
	else
	{
	$(outside).slideDown( "fast", function () {
		$(inside).fadeIn( "fast");			
	});	
	}

// javascript to show icons when button is hovered over
	$(outside).hover(
  		function() {
			$(deleteICON).show();
			$(editICON).show();
		}, function() {
            $(deleteICON).hide();
			$(editICON).hide();
	});
	
//Javascript to when user switches pages
	var switchPAGE = (function(e){
		if(e.target !=editICON && e.target != deleteICON && !$(inside).hasClass("Current")){
			$("#Wcontainer div.ButtonInside:eq(" + currentBUTTON + ")").switchClass( "Current", "Other", 400, "easeInOutQuad" );
			$(inside).switchClass( "Other", "Current", 400, "easeInOutQuad" );
			$(inside).unbind("click", switchPAGE);
			$(currentPAGE).fadeOut( "fast", function(){
					$(page).fadeIn( "fast");
					});
			
			currentBUTTON = $(outside).index();
			currentPAGE = page;

//Did this to prevent click same page twice
			setTimeout( 
		        function() {
		             	$(inside).bind("click", switchPAGE);
		        }
		    , 500);	    
		}
    });
	$(inside).bind("click", switchPAGE); 
	
}

// Javascript function that is performed when a page is deleted
// outside and inside are parts of the template button, page specifies that droppable area
function removeBOX (outside, inside/*, page*/) 
{		
	var deletedPAGE = $(outside).index();
	if (currentBUTTON > deletedPAGE)
		currentBUTTON--;

// Javascript to open new page if current viewing page is removed
	if ($(inside).hasClass('Current')){
		if(currentBUTTON==0)
			{
			$("#Wcontainer div.ButtonInside:eq(1)").switchClass( "Other", "Current", 400, "easeInOutQuad" );
//			$("#droppableParent div.droppable:eq(1)").fadeIn("fast");
			currentPAGE = $("#droppableParent div.droppable:eq(1)");
			}
		else
			{
			$("#Wcontainer div.ButtonInside:eq(0)").switchClass( "Other", "Current", 400, "easeInOutQuad" );
//			$("#droppableParent div.droppable:eq(0)").fadeIn("fast");
			currentPAGE = $("#droppableParent div.droppable:eq(0)");
			}

//		$(page).fadeOut( "fast", function (){
//			page.remove();
//			});
		currentBUTTON=0;
	};

// animation to remove page template		
	$(inside).fadeOut( "fast", function () {
		$(outside).slideUp( "fast", function () {
			outside.remove();
		});
	});	

	--pagecount;
}




$(function() {
// specifies that element tiles can be dragged
	$( ".draggable" ).draggable({
		revert: 'invalid',
		});
// background turns grey when element is dragged to clarify droppable area to user		
	$(".draggable").mousedown(function(){
			$("#background").stop(true, true).animate({backgroundColor: "gray"}, 400);
			$(this).css( "zIndex", 6 );	
	});

	$(".draggable").mouseup(function(){
			$("#background").stop(true, true).animate({backgroundColor: "white"}, 400);
			$(this).css( "zIndex", 5 );	
	});
// element parents change color when hovered and when elements are dragged
	$( ".elementBox" ).hover(
        function() {
			$( this ).stop(true, true).animate({backgroundColor: "#3d5165",}, 500 );
		}, function() {
			$( this ).stop(true, true).animate({backgroundColor: "#34485c",}, 500 );
		}
    );
});

// function performed when an element is dropped
function dropFunction(appendElement, load){
// find out which element is being appended
			if (load=="none")
				var droppedItem = event.target.id;
	        else
				var droppedItem = load;
			$("#" + droppedItem).hide('drop', { direction: 'down' }, "normal", function(){

				$("#" + droppedItem).fadeIn("normal");
			});
		
};
	
</script>
 
  <title>SmartArt</title>  
</head>

<body>
<div class="logo">
</div>

<div style="width:235px; min-height:855; background-color: #2c3e50; position:relative; top:0px; padding-top:41px;">
<!-- Template buttons -->
	<div class="header" style="border-top:0px; height:24px;">PROJECTS</div>
	<div id="Wcontainer" style="margin-top:24px; position:relative; display:block; margin-bottom:10px; width:100%;"> 
	</div>

	<div id="pageADD"  class="pageADD">
		<form><input id="pageTEXT" type="text" name="pagename" maxlength="20" class="textBOXbutton" placeholder="ADD PROJECT"></form>
		<img onClick="newBOX('user')" id="Add-Icon" src="Images/Add-Icon.png" alt="Add Page" style="position:absolute; float:right; top:8px; right:9px;">
		</div>
<!-- Element boxes -->
	<div class="header" style="box-shadow: 0px 2px 2px 0px rgba(0, 0, 0, 0.3); z-index:1;">ELEMENTS</div>
		<div style="height:216px; position:relative;">
        	<div class="elementBox" style=" position:relative; width:117px; height: 107px; background-color:#34485c; float:left; border-right: 2px solid #21313f; border-bottom: 2px solid #21313f;">
				<img id="TitleElement" class="draggable" src="Images/Title-Element.png" alt="Title" style="top:20px; left:32px;">
        		<div style="color:5e768e; font-size:13px; font-weight:bold; position:absolute; left:41px; top:84px;">TITLE</div>
        		</div>
        
        		<div class="elementBox" style="position:relative; width:115px; height: 107px; background-color:#34485c; float:right; border-left: 1px solid #45586c; border-bottom: 2px solid #21313f;">
      			<img id= "TextElement" class="draggable" src="Images/Text-Element.png" alt="Text" style="top:20px; right:32px;">
        		<div style="color:5e768e; font-size:13px; font-weight:bold; position:absolute; right:43px; top:84px;">TEXT</div>
        	</div>
        
        	<div class="elementBox" style="position:relative; width:117px; height: 106px; background-color:#34485c; float:left; border-top: 1px solid #45586c; border-right: 2px solid #21313f;">
            	<img id="ImageElement" class="draggable" src="Images/Image-Element.png" alt="Image" style="top:18px; left:32px;">
        		<div style="color:5e768e; font-size:13px; font-weight:bold; position:absolute; left:39px; top:82px;">IMAGE</div>
        	</div>
        
        	<div class="elementBox" style="position:relative; width:115px; height: 106px; background-color:#34485c; float:right; border-top: 1px solid #45586c; border-left: 1px solid #45586c;">
       			<img id="NavElement" class="draggable" src="Images/Nav-Element.png" alt="Nav" style="top:18px; right:32px;">
       			<div style="color:5e768e; font-size:13px; font-weight:bold; position:absolute; right:45px; top:82px;">NAV</div>
        		</div>
    			</div>
        
        <div style="width:235px; height:2px; position:relative; background-color:#21313f; bottom:0px; border-bottom:1px solid #374859"></div>
</div>

<! Parent for droppable pages -->
<div id = "background" style="z-index:2; background-color:white; box-shadow: -2px 0px 7px 0px rgba(0, 0, 0, 0.5); min-width:calc(100% - 235px); min-height:100%; position:absolute; top:0px; margin-left:235px; padding-top:41px;">
	<div id="droppableParent" style="width:857px; position:relative; margin-left:auto; margin-right:auto;">
    	<div class = "droppable" style="display:block;">
    
    
    
    
    
    
    
    
    
    
    
    <div style="width:400px;">
	<div id="preview"></div>
	
    <div class="container" id="upload_button">
            <div class="button" style="cursor:pointer;">
    			<div style = "text-align:center; top:0%; z-index:5; position:relative; cursor:pointer;">Upload</div>
 				<input class = "upload" type="file" name="file_array[]" multiple id="file_select" onChange="handleFiles(this.files)">			
           </div>     
    </div> 
</div>
    
    
    
    
    
    
    
    
    
    
    
    	</div>
    </div>
</div>

<script>
// function to change color of add icon depending
$("#pageADD").hover(
  function() {
		 if (!($("#pageTEXT").is(":focus"))) {
    		$("#Add-Icon").attr("src","Images/Add-Icon Hover.png");}
         $("#pageTEXT").focus(
  			function() {
         		$("#Add-Icon").attr("src","Images/Add-Icon.png");
				$("#Add-Icon").hover(
 					function() {
         				$("#Add-Icon").attr("src","Images/Add-Icon Hover.png");
					}, function() {
         				$("#Add-Icon").attr("src","Images/Add-Icon.png");
				});				 
		 });
  }, function() {
         $("#Add-Icon").attr("src","Images/Add-Icon.png");
});

// allows new box to be creater by pressing enter button
$("#pageTEXT").keypress(function( event ) {
    if ( event.which == 13 ){
        event.preventDefault();
            newBOX("user");
            $("#pageTEXT").blur();
    }
})
</script>

</body>
</html>

